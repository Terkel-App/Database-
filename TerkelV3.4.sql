DROP SCHEMA mydb;


-- MySQL Script generated by MySQL Workbench
-- 03/29/16 12:19:05
-- Model: New Model    Version: 1.0
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`School`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`School` (
	`SchoolID` INT NOT NULL AUTO_INCREMENT,
	`SchoolName` VARCHAR(45) NULL,
PRIMARY KEY (`SchoolID`))
ENGINE = InnoDB;



-- -----------------------------------------------------
-- Table `mydb`.`Login`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Login` (
	`LoginID` INT NOT NULL AUTO_INCREMENT,
	`Username` VARCHAR(15) NULL,
	`Password` VARCHAR(15) NULL,
PRIMARY KEY (`LoginID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Room`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Room` (
	`RoomID` INT NOT NULL AUTO_INCREMENT,
	`Name` VARCHAR(45) NULL,
	`Location` VARCHAR(45) NULL,
PRIMARY KEY (`RoomID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`TimeTable`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TimeTable`(
INDEX(Course(3)),
	`TimeTableID` INT NOT NULL AUTO_INCREMENT,
	`Week` VARCHAR(45) NULL,
	`Day` VARCHAR(45) NULL,
	`Course` VARCHAR(45) NULL,
	`Room` VARCHAR(45) NULL,
PRIMARY KEY (`TimeTableID`))

ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`RoomTime`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`RoomTime` (
	`RoomTimeID` INT NOT NULL AUTO_INCREMENT,
	`Name` VARCHAR(45) NULL,
	`Location` VARCHAR(45) NULL,
	`RoomID` INT NULL,
	`TimeTableID` INT NULL,
PRIMARY KEY (`RoomTimeID`),
CONSTRAINT `RoomID`
	FOREIGN KEY (`RoomTimeID`)
REFERENCES `mydb`.`Room` (`RoomID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION,
CONSTRAINT `TimeTableID`
	FOREIGN KEY (`TimeTableID`)
REFERENCES `mydb`.`TimeTable` (`TimeTableID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ClassSubject`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ClassSubject` (
INDEX(Subject(3)),
	`ClassSubjectID` INT NOT NULL AUTO_INCREMENT,
	`Class` VARCHAR(45) NULL,
	`Subject` VARCHAR(45) NULL,
	`SchoolID` INT NULL,
	`RoomTimeID` INT NULL,
PRIMARY KEY (`ClassSubjectID`),
CONSTRAINT `SchoolID`
	FOREIGN KEY (`SchoolID`)
REFERENCES `mydb`.`School` (`SchoolID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION,
CONSTRAINT `RoomTimeID`
	FOREIGN KEY (`RoomTimeID`)
REFERENCES `mydb`.`RoomTime` (`RoomTimeID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Guardian`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Guardian` (
INDEX(Lastname(3)),
	`GuardianID` INT NOT NULL AUTO_INCREMENT,
	`Firstname` VARCHAR(45) NULL,
	`Lastname` VARCHAR(45) NULL,
	`Username` VARCHAR(45) NULL,
	`Password` VARCHAR(45) NULL,
	`Telephone` INT(8) NULL,
	`StudentID` INT NULL,
PRIMARY KEY (`GuardianID`),
CONSTRAINT `StudentID`
	FOREIGN KEY (`StudentID`)
REFERENCES `mydb`.`Student` (`StudentID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `mydb`.`Student`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Student` (
INDEX(Lastname(3)),
	`StudentID` INT NOT NULL AUTO_INCREMENT,
	`Firstname` VARCHAR(45) NULL,
	`Lastname` VARCHAR(45) NULL,
	`Username` VARCHAR(45) NULL,
	`Password` VARCHAR(45) NULL,
	`Email` VARCHAR(45) NULL,
	`Telephone` INT(8) NULL,
	`SchoolID` INT NOT NULL,


PRIMARY KEY (`StudentID`),
FOREIGN KEY (`SchoolID`)
REFERENCES `mydb`.`School` (`SchoolID`))

ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`StudentSubject`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`StudentSubject` (
INDEX(Subject(3)),
	`StudentSubjectID` INT NOT NULL AUTO_INCREMENT,
	`Subject` VARCHAR(45) NULL,
	`StudentID` INT NULL,
	`ClassSubjectID` INT NULL,
PRIMARY KEY (`StudentSubjectID`),
CONSTRAINT `StudentID2`
	FOREIGN KEY (`StudentID`)
REFERENCES `mydb`.`Student` (`StudentID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION,
CONSTRAINT `ClassSubjectID`
	FOREIGN KEY (`ClassSubjectID`)
REFERENCES `mydb`.`ClassSubject` (`ClassSubjectID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;





-- -----------------------------------------------------
-- Table `mydb`.`Teacher`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Teacher` (
INDEX(Lastname(3)),
	`TeacherID` INT NOT NULL AUTO_INCREMENT,
	`Firstname` VARCHAR(45) NULL,
	`Lastname` VARCHAR(45) NULL,
	`Username` VARCHAR(45) NULL,
	`Password` VARCHAR(45) NULL,
	`Email` VARCHAR(45) NULL,
	`Telephone` INT(8) NULL,
	`kontaktlarer` TINYINT(1),
	`SchoolID` INT NOT NULL,


PRIMARY KEY (`TeacherID`),
FOREIGN KEY (`SchoolID`)
REFERENCES `mydb`.`School` (`SchoolID`))

ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`TeacherSubject`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TeacherSubject` (
	`TeacherSubjectID` INT NOT NULL AUTO_INCREMENT,
	`Subject` VARCHAR(45) NULL,
	`TeacherID` INT NULL,
	`ClassSubjectID` INT NULL,
PRIMARY KEY (`TeacherSubjectID`),
CONSTRAINT `TeacherID2`
	FOREIGN KEY (`TeacherID`)
REFERENCES `mydb`.`Teacher` (`TeacherID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION,
CONSTRAINT `ClassSubjectID2`
	FOREIGN KEY (`ClassSubjectID`)
REFERENCES `mydb`.`ClassSubject` (`ClassSubjectID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Message`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Message` (
INDEX(Title(3)),
	`MessageID` INT NOT NULL AUTO_INCREMENT,
	`SentDatetime` DATETIME NULL,
	`Title` VARCHAR(45) NULL,
	`MessagesText` VARCHAR(45) NULL,
	`RoomTimeID` INT NULL,
PRIMARY KEY (`MessageID`),
CONSTRAINT `RoomTimeID2`
    FOREIGN KEY (`RoomTimeID`)
REFERENCES `mydb`.`RoomTime` (`RoomTimeID`)
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `mydb`.`Recipient`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Reciepient` (
	`RecipientID` INT NOT NULL AUTO_INCREMENT,
	`MessageID` INT,
	`TeacherID` INT,
	`StudentID` INT,
PRIMARY KEY (`RecipientID`),
	FOREIGN KEY (`MessageID`)
REFERENCES `mydb`.`Message` (`MessageID`),
	FOREIGN KEY (`TeacherID`)
REFERENCES `mydb`.`Teacher` (`TeacherID`),
	FOREIGN KEY (`StudentID`)
REFERENCES `mydb`.`Student` (`StudentID`))
ENGINE = InnoDB;











SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;




-- Inserts.. -- dummie data
/*

-- Skole..
INSERT INTO School (SchoolID, SchoolName)
VALUES ('0001','Universitetet i Agder');
INSERT INTO School (SchoolID, SchoolName)
VALUES ('0002','Kvadraturen');
INSERT INTO School (SchoolID, SchoolName)
VALUES ('0003','Tangen');


INSERT INTO Login (LoginID, Username, Password)
VALUES ('0001','2211', '1122');
INSERT INTO Login (LoginID, Username, Password)
VALUES ('0002','3322', '2233');

-- Klasserom..
INSERT INTO Room (RoomID, Name, Location)
VALUES ('0001','B','Syd');
INSERT INTO Room (RoomID, Name, Location)
VALUES ('0002','A','Nord');

-- timeplan..
INSERT INTO TimeTable (TimeTableID, Week, Day, Course, Room)
VALUES ('0001','21','Mandag', 'Norsk', '0001');
INSERT INTO TimeTable (TimeTableID, Week, Day, Course, Room)
VALUES ('0002','23','Tirsdag', 'Engelsk', '0002');

-- Romtid..
INSERT INTO RoomTime (RoomTimeID, Name, Location, RoomID, TimeTableID)
VALUES ('0001','B','Syd', '0048', '0001');
INSERT INTO RoomTime (RoomTimeID, Name, Location, RoomID, TimeTableID)
VALUES ('0002','A','Nord', '0058', '0002');
-- Fag klasser..
INSERT INTO ClassSubject (ClassSubjectID, Class, Subject, SchoolID, RoomtimeID)
VALUES ('0001','2B','Norsk', '0001', '0001');
INSERT INTO ClassSubject (ClassSubjectID, Class, Subject, SchoolID, RoomtimeID)
VALUES ('0002','3B','Engelsk', '0002', '0002');

-- Student..
INSERT INTO Student (StudentID, Firstname, Lastname)
VALUES ('0001','Thomas','Olsen');
INSERT INTO Student (StudentID, Firstname, Lastname)
VALUES ('0002','Asim','Khan');
INSERT INTO Student (StudentID, Firstname, Lastname)
VALUES ('0003','Thananchai','Prasomwong');
INSERT INTO Student (StudentID, Firstname, Lastname)
VALUES ('0004','Sondre','Lind');
-- foresatte..
INSERT INTO Guardian (GuardianID, Firstname, Lastname, StudentID)
VALUES ('0001','Frank','Frankesen', '0001');
INSERT INTO Guardian (GuardianID, Firstname, Lastname, StudentID)
VALUES ('0002','Ole','Olsen', '0002');
-- Studentens fagområder..
INSERT INTO StudentSubject (StudentSubjectID, Subject, StudentID, ClassSubjectID)
VALUES ('0001','Norsk','0001', '0001');
INSERT INTO StudentSubject (StudentSubjectID, Subject, StudentID, ClassSubjectID)
VALUES ('0002','Engelsk','0002', '0002');
INSERT INTO StudentSubject (StudentSubjectID, Subject, StudentID, ClassSubjectID)
VALUES ('0003','Engelsk','0003', '0002');

-- Lærer..
-- INSERT INTO Teacher (TeacherID, Firstname, Lastname)
-- VALUES ('0001','Ole','Olsen');
-- INSERT INTO Teacher (TeacherID, Firstname, Lastname)
-- VALUES ('0002','Per','Person');
-- INSERT INTO Teacher (TeacherID, Firstname, Lastname)
-- VALUES ('0003','Jan','Janesen');

-- Lærerens fagområder.
INSERT INTO TeacherSubject (TeacherSubjectID, Subject, TeacherID, ClassSubjectID)
VALUES ('0001','Norsk','0001', '0001');
INSERT INTO TeacherSubject (TeacherSubjectID, Subject, TeacherID, ClassSubjectID)
VALUES ('0002','Engelsk','0002', '0002');
-- Message..
